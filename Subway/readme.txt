http://codeforces.com/contest/131/problem/D
 
dfs and similar, graphs, *1600

